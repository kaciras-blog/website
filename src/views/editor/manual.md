# Kaciras Blog 评论说明

# 编辑器

为了适配不同的设备和场景，本站拥有 3 种编辑器：

![简易编辑框](/editor-demo/embed.webp)

![移动端编页面](/editor-demo/mobile.webp?vw=257&vh=450)

![完整版编辑器](/editor-demo/standalone.webp)

评论区默认的编辑器在宽屏下是一个简易的编辑框，在移动端会弹出编辑页面，这两种编辑器较简单，适用于短评论。

在宽屏下点击`完整版编辑器`按钮将加载功能更丰富的编辑器，适用于写较长的评论。因为该编辑器体积较大，所以没有作为首选。

关于编辑器以及扩展语法的实现见 [https://github.com/kaciras-blog/markdown](https://github.com/kaciras-blog/markdown)。

# 扩展的 Markdown

本站使用了自定义的 Markdown，下称 KFM（Kaciras Flavored Markdown），兼容标准的 Markdown 语法，同时添加了一些新的功能，以下仅介绍自定义的部分。

## 禁止 HTML

KFM 不推荐在 Markdown 中使用 HTML。

<details>
<summary>
为什么
</summary>
Markdown 是轻量级的标记语言，轻量级指的是语法符号（如`![]()`,`#`）占内容的比例很低，而 HTML 则是重量级的。 轻量级的语言即使不渲染也易读，而 HTML 没有该优势。

另一个原因是 Markdown 并不一定会渲染为 HTML，虽然大多数情况是如此。一旦支持 HTML 就会限制其渲染成其他目标的能力。

最后混用还会让解析将变得复杂，比如替换图片的 URL，原本只需要搜索 `![...](...)`，而引入 HTML 后则需要专门的解析器。
</details>

## 折叠块

折叠块使用与 HTML 相似的语法，不过要求 `<summary>` 必须在第一行。在底层该功能是由单独的解析器实现的，而非开启了 HTML 功能。

<details>
<summary>
点击折叠块的标题部分切换开关。
</summary>
里头是内容。
</details>

## 更多的媒体类型

标准的 Markdown 并不支持视频音频等媒体元素，KFM 中使用了自定义的语法来表示它们。

### 视频

方括号内是视频的封面，如果留空则由浏览器自动选择。视频无法自动播放，只能由用户点击开始。

@video[](/editor-demo/video.mp4)

### 视频作为动态图

传统的 GIF 图片算法落后，很多平台已经用视频来替换它们，KFM 也支持这种做法。GIF 视频默认是静音的，且会自动播放。

GIF 和普通的图片一样，支持用 `vw` 和 `vh` URL 参数设置尺寸。

@gif[GIF 视频](/editor-demo/video.mp4?vw=420&vh=420)

### 音频

@audio[音频标签](/editor-demo/audio.mp3)

# 中英文之间的空白

KFM 推荐在中英文不同的单词之间添加一个空格，这有利于让不同平台间排版保持一致。

<details>
<summary>
详细的说明
</summary>
由于中文（也包括日韩文）跟英文之视觉上的差异，导致它们在排版上区别很大。当中英文单词相邻时应当添加适当的空白，这样更易阅读。

如何实现这一点有两种方案：在原文添加空格以及由排版引擎去做。

我支持在原文添加空格的做法，原因有：

1. 英文单词之间需要有空格，故它跟前后中文不是一个单词时必须加空格。
2. 并非所有平台都对混排做了优化，目前浏览器并不支持该功能。
3. 仅靠中英文字相邻不能判定为两个单词，比如“QQ音乐”是一个单词，还有颜文字、URL 只能算作一个词，自动加空格不好实现。
</details>
